---
layout: post
title: "计算机网络基本知识"
subtitle: "一些基本概念"
date: 2016-10-21 21:00:00
author: "seventhking"
header-img: "img/home-bg-o.jpg"
catalog: true
tags:
    - network
---

> "基本概念"

### IP地址分类

|类别&nbsp;&nbsp;&nbsp;|最大网络数&nbsp;&nbsp;&nbsp;|IP地址范围&nbsp;&nbsp;&nbsp;|最大主机数&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;私有IP地址范围&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;子网掩码
|:----------------------|:---------------|:---------------------------|-------:|:-----------
|A|126(2^7-2)|0.0.0.0-127.255.255.255|16777214(2^24 - 2)|&nbsp;&nbsp;&nbsp;10.0.0.0-10.255.255.255|&nbsp;&nbsp;&nbsp;255.0.0.0
|B|16384(2^14)|128.0.0.0-191.255.255.255 |65534(2^16 - 2)|&nbsp;&nbsp;&nbsp;172.16.0.0-172.31.255.255|&nbsp;&nbsp;&nbsp;255.255.0.0
|C|2097152(2^21)|192.0.0.0-223.255.255.255 |254(2^8 - 2)|&nbsp;&nbsp;&nbsp;192.168.0.0-192.168.255.255|&nbsp;&nbsp;&nbsp;255.255.255.0

## 物理层
物理层所做的只是接收一个原始比特流，并试图将它传递给目标机器。  

## 数据链路层
数据链路层使用物理层提供的服务在通信信道上发送和s接收比特：  
（1）向网络层提供一个定义良好的服务接口  
（2）处理传输错误  
（3）调节数据流，确保慢速的接收方不会被快速的发送方淹没  

~~~
  发送机器                             接收机器
     |                                   ^
     v                                   |
   数据包                               数据包
     |                                   ^
     v                                   |
帧头：有效载荷：帧尾                 帧头：有效载荷：帧尾
     |                                   ^
     v                                   |
     -------------------------------------
~~~

数据链路层通常会提供以下3种可能的服务：  
（1）无确认的无连接服务：源机器向目标机器发送独立的帧，目标机器并不对这些帧进行确认。事先不需要建立逻辑连接，  
    事后也不用释放逻辑连接。不做丢帧的特殊处理。例如：以太网。适用场景：1.错误率很低的场合，差错恢复交给上层  
    2.实时通信，比如语音传输，因为在实时通信种数据迟到比数据受损更糟糕
（2）有确认的无连接服务：数据链路层没有使用逻辑连接，但其发送的每一帧都需要单独确认。这样，发送方可知道一个帧  
    是否已经正确地到达目的地。若一个帧在指定时间间隔内还没有到达，则发送方将再次发送该帧。这类服务尤其适用于不  
    可靠信道，比如无限系统。802.11（WiFi）  
    
    值得强调的是，在数据链路层提供确认只是一种优化手段，永远不应该成为一种需求。网络层总是可以发送一个数据包，  
    然后等待该数据包被确认。如果在计时器超时之前，该数据包的确认还没有到来，那么发送方只要再次发送整个报文即可。  
    这一策略的麻烦在于它可能导致传输的低效率。链路层对帧通常有严格的长度限制，这是由硬件所决定的；除此之外，还有  
    传播延迟。但网络层不清楚这些参数。网络层可能发出了一个很大的数据包，该数据包被拆分并封装到10个帧中，而且20%  
    的帧在传输中被丢失，那么这个数据包可能需要花很长的时间才能传到接收方。相反地，如果每个帧都单独确认和必要时重传，  
    那么出现的差错就能更直接并且更快的被检测到。在可靠信道上，比如光纤，重量级数据链路协议的开销可能是不必要的；  
    但在无线信道上，由于信道内在的不可靠性，这种开销还是非常值得的。  

（3）有确认的有连接服务：源机器和目标机器在传输任何数据之前要建立一个连接。连接上发送的每一帧都被编号，数据  
    链路层确保发出的每个帧都会真正被接收方收到。它还保证每个帧只被接收一次，并且所有的帧都将按正确的顺序  
    被接收。因此，面向连接的服务相当于为网络层进程提供了一个可靠的比特流。它适用于长距离且不可靠的链路，  
    比如卫星信道或者长途电话电路。如果采用有确认的无连接服务，可以想象丢失了确认可能导致一个帧被收发多次，  
    因而将浪费带宽。
    
    当使用面向连接的服务时，数据传输必须经过三个不同阶段。第一个阶段，要建立连接，双方初始化各种变量和计数器，这些  
    变量和计数器记录了哪些帧已经接收到，哪些帧还没有收到。在第二个阶段，才真正传输一个或者多个数据帧。在第三个也是最  
    后一个阶段中，连接被释放，所有的变量、缓冲区以及其他用于维护该连接的资源也随之被释放。  

#### 成帧方法
（1）字节计数法：帧头标识帧中字符数，很少使用  
（2）字节填充的标志字节法：标志字节作为帧的开始和结束分界符，ESC转义  
（3）比特填充的标志比特法：特殊的比特模式作为开始和结束分界符，“0111 1110”0x7E标记，  
    遇到连续五个1，自动在输出的比特流中插入一个比特0  
    
    填充法的缺点是帧的长度会增幅大约12.5%
（4）物理层编码违禁法：冗余比特  


#### 流量控制
（1）基于反馈的流量控制：大多数  
（2）基于速率的流量控制：仅在传输层的一部分中可见  

作为链路层硬件实现的网络接口卡(NIC)，有时声称能以“线速”运行，所以任何过载不再是链路层的问题，它们必须由高层来处理  


#### 差错检测和纠正
1.纠错码：前向纠错  
(1)海明码  
(2)二进制卷积码  
(3)里德所罗门码  
(4)低密度奇偶校验码  

2.检错码  
（1）奇偶  
（2）校验和  
（3）循环冗余校验（CRC）：多项式  

~~~
应用程序
网络层
链路层(驱动器)
链路层（网络接口卡NIC）
物理层（线缆（介质））
~~~


### 网桥(以太网交换机)
网桥工作在数据链路层，  

它们通过检查数据链路层地址来转发帧  


#### 后向学习算法

##### 泛洪算法

#### 生成树算法


### 中继器，集线器
工作在物理层

### 路由器
工作在网络层

### 传输网关
工作在传输层

### 应用网关
工作在应用层


## 网络层

### 数据报网络  VS   虚电路网络
~~~
问题                     数据报网络(无连接)                          虚电路网络(有连接)

电路建立                  不需要                                    需要

寻址                     每个包包含全部的源和目的地址                  每个包包含间短的VC号

状态信息                  路由器不保留连接状态                        针对每个连接，每条VC都需要路由器保存其状态

路由方式                  每个数据包被单独路由                        建立VC时选择路由，所有包都遵循该路由

路由器失效的影响           没影响，除了那些路由器崩溃期间丢失的包         穿过故障路由器的所有VC都将中断

服务质量                  困难                                     容易，如果在预先建立每条VC时有足够的资源可分配

拥塞控制                  困难                                     容易，如果在预先建立每条VC时有足够的资源可分配
~~~

### 数据包分段

每个网络或链路都会限制其数据包的最大长度，限制来自多方面的原因，其中包括：  
（1）硬件 （比如以太网帧的长度限制）  
（2）操作系统 （比如所有的缓冲区都是512字节）  
（3）协议 （比如，数据包长度字段中的位数）  
（4）遵从某个国家（或国际）标准  
（5）期望将错误引入的重传次数减少到某种程度  
（6）期望防止数据包占用信道时间太长  

一些常用技术的最大有效载荷长度：  
1.以太网     1500字节  
2.802.11协议 2272字节  
3.IP协议     65515


#### MTU(Path Maximum Transmission Unit)
路径最大传输单元  

#### 透明分段 VS 非透明分段(IP)


#### Internet 通信过程
理论上，每个数据包最大容纳64KB，但实际上，数据包通常不超过1500字节(因而它么正好可被放到一个以太网帧中)

#### IPv4协议
```
|------------------------------------------------------------------------|
|版本   |    IHL      |       区分服务  |           总长度                  |
|-------------------------------------|----------------------------------|
|标识                                  | |DF|MF|    分段偏移量             |
|------------------------------------------------------------------------|
|生存期             |         协议      | 头检验和                          |
|------------------------------------------------------------------------|
|源地址                                                                   |
|------------------------------------------------------------------------|
|目的地址                                                                 |
|------------------------------------------------------------------------|
|选项                                                                    |
|------------------------------------------------------------------------

IHL：头长，单位 4byte
总长度：该数据报中的所有内容，即头和数据，最大长度是65535个字节
标识：让目标主机确定一个新到达的分段属于哪一个数据报。同一个数据报的所有段包含同样的标识值
未使用：
DF：不分段标识，不允许路由器分割该数据报
MF：更多的段，除了最后一个段以外，其他所有的段都必须设置这一位，它的用途是接收方可以知道什么时候一个数据报的所有分段都已经到达了
分段偏移量：指明该段在当前数据报中的位置。除了数据报的最后一个段以外，其他所有段的长度必须是8字节的倍数。由于该字段有13位，所以每个数据报最多有8192个段，由此支持Total length字段限制的最大数据报
生存期：
协议：指明将它交给哪个传输进程，TCP是一种可能，UDP或者其他协议也有可能
```

#### IP地址
每个32位地址由高位的可变长网络和低位的主机两部分数据组成


